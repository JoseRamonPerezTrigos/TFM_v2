--------------------------------------------------
o")~   Snort++ 3.3.1.0
--------------------------------------------------
Loading /usr/local/etc/snort/snort.lua:
Loading snort_defaults.lua:
Finished snort_defaults.lua:
	active
	alerts
	daq
	file_id
	sip
	ips
	classifications
	ssh
	appid
	ssl
	file_policy
	dnp3
	http_inspect
	ftp_data
	ftp_client
	ftp_server
	smtp
	port_scan
	gtp_inspect
	dce_http_server
	dce_http_proxy
	dce_udp
	dce_tcp
	dce_smb
	s7commplus
	modbus
	mms
	iec104
	http2_inspect
	cip
	telnet
	js_norm
	wizard
	binder
	rpc_decode
	pop
	normalizer
	netflow
	imap
	output
	dns
	back_orifice
	stream_file
	stream_udp
	stream_ip
	stream
	references
	search_engine
	decode
	host_cache
	host_tracker
	hosts
	network
	packets
	process
	so_proxy
	stream_icmp
	stream_tcp
	trace
	stream_user
	arp_spoof
Finished /usr/local/etc/snort/snort.lua:
Loading file_id.rules_file:
Loading file_magic.rules:
Finished file_magic.rules:
Finished file_id.rules_file:
Loading ips.rules:
Loading ../rules/snort3-community.rules:
Finished ../rules/snort3-community.rules:
Loading ../rules/3.0.0.0/includes.rules:
Loading snort3-app-detect.rules:
Finished snort3-app-detect.rules:
Loading snort3-browser-chrome.rules:
Finished snort3-browser-chrome.rules:
Loading snort3-browser-firefox.rules:
Finished snort3-browser-firefox.rules:
Loading snort3-browser-ie.rules:
Finished snort3-browser-ie.rules:
Loading snort3-browser-other.rules:
Finished snort3-browser-other.rules:
Loading snort3-browser-plugins.rules:
Finished snort3-browser-plugins.rules:
Loading snort3-browser-webkit.rules:
Finished snort3-browser-webkit.rules:
Loading snort3-content-replace.rules:
Finished snort3-content-replace.rules:
Loading snort3-exploit-kit.rules:
Finished snort3-exploit-kit.rules:
Loading snort3-file-executable.rules:
Finished snort3-file-executable.rules:
Loading snort3-file-flash.rules:
Finished snort3-file-flash.rules:
Loading snort3-file-identify.rules:
Finished snort3-file-identify.rules:
Loading snort3-file-image.rules:
Finished snort3-file-image.rules:
Loading snort3-file-java.rules:
Finished snort3-file-java.rules:
Loading snort3-file-multimedia.rules:
Finished snort3-file-multimedia.rules:
Loading snort3-file-office.rules:
Finished snort3-file-office.rules:
Loading snort3-file-other.rules:
Finished snort3-file-other.rules:
Loading snort3-file-pdf.rules:
Finished snort3-file-pdf.rules:
Loading snort3-indicator-compromise.rules:
Finished snort3-indicator-compromise.rules:
Loading snort3-indicator-obfuscation.rules:
Finished snort3-indicator-obfuscation.rules:
Loading snort3-indicator-scan.rules:
Finished snort3-indicator-scan.rules:
Loading snort3-indicator-shellcode.rules:
Finished snort3-indicator-shellcode.rules:
Loading snort3-malware-backdoor.rules:
Finished snort3-malware-backdoor.rules:
Loading snort3-malware-cnc.rules:
Finished snort3-malware-cnc.rules:
Loading snort3-malware-other.rules:
Finished snort3-malware-other.rules:
Loading snort3-malware-tools.rules:
Finished snort3-malware-tools.rules:
Loading snort3-netbios.rules:
Finished snort3-netbios.rules:
Loading snort3-os-linux.rules:
Finished snort3-os-linux.rules:
Loading snort3-os-mobile.rules:
Finished snort3-os-mobile.rules:
Loading snort3-os-other.rules:
Finished snort3-os-other.rules:
Loading snort3-os-solaris.rules:
Finished snort3-os-solaris.rules:
Loading snort3-os-windows.rules:
Finished snort3-os-windows.rules:
Loading snort3-policy-multimedia.rules:
Finished snort3-policy-multimedia.rules:
Loading snort3-policy-other.rules:
Finished snort3-policy-other.rules:
Loading snort3-policy-social.rules:
Finished snort3-policy-social.rules:
Loading snort3-policy-spam.rules:
Finished snort3-policy-spam.rules:
Loading snort3-protocol-dns.rules:
Finished snort3-protocol-dns.rules:
Loading snort3-protocol-finger.rules:
Finished snort3-protocol-finger.rules:
Loading snort3-protocol-ftp.rules:
Finished snort3-protocol-ftp.rules:
Loading snort3-protocol-icmp.rules:
Finished snort3-protocol-icmp.rules:
Loading snort3-protocol-imap.rules:
Finished snort3-protocol-imap.rules:
Loading snort3-protocol-nntp.rules:
Finished snort3-protocol-nntp.rules:
Loading snort3-protocol-other.rules:
Finished snort3-protocol-other.rules:
Loading snort3-protocol-pop.rules:
Finished snort3-protocol-pop.rules:
Loading snort3-protocol-rpc.rules:
Finished snort3-protocol-rpc.rules:
Loading snort3-protocol-scada.rules:
Finished snort3-protocol-scada.rules:
Loading snort3-protocol-services.rules:
Finished snort3-protocol-services.rules:
Loading snort3-protocol-snmp.rules:
Finished snort3-protocol-snmp.rules:
Loading snort3-protocol-telnet.rules:
Finished snort3-protocol-telnet.rules:
Loading snort3-protocol-tftp.rules:
Finished snort3-protocol-tftp.rules:
Loading snort3-protocol-voip.rules:
Finished snort3-protocol-voip.rules:
Loading snort3-pua-adware.rules:
Finished snort3-pua-adware.rules:
Loading snort3-pua-other.rules:
Finished snort3-pua-other.rules:
Loading snort3-pua-p2p.rules:
Finished snort3-pua-p2p.rules:
Loading snort3-pua-toolbars.rules:
Finished snort3-pua-toolbars.rules:
Loading snort3-server-apache.rules:
Finished snort3-server-apache.rules:
Loading snort3-server-iis.rules:
Finished snort3-server-iis.rules:
Loading snort3-server-mail.rules:
Finished snort3-server-mail.rules:
Loading snort3-server-mssql.rules:
Finished snort3-server-mssql.rules:
Loading snort3-server-mysql.rules:
Finished snort3-server-mysql.rules:
Loading snort3-server-oracle.rules:
Finished snort3-server-oracle.rules:
Loading snort3-server-other.rules:
Finished snort3-server-other.rules:
Loading snort3-server-samba.rules:
Finished snort3-server-samba.rules:
Loading snort3-server-webapp.rules:
Finished snort3-server-webapp.rules:
Loading snort3-sql.rules:
Finished snort3-sql.rules:
Loading snort3-x11.rules:
Finished snort3-x11.rules:
Finished ../rules/3.0.0.0/includes.rules:
Finished ips.rules:
--------------------------------------------------
ips policies rule stats
              id  loaded  shared enabled    file
               0   45940    4020   45940    /usr/local/etc/snort/snort.lua
--------------------------------------------------
rule counts
       total rules loaded: 45940
          duplicate rules: 4020
               text rules: 45940
            option chains: 45940
            chain headers: 6200
                 flowbits: 712
     flowbits not checked: 69
--------------------------------------------------
port rule counts
             tcp     udp    icmp      ip
     any    1820     391     471     298
     src    1241     157       0       0
     dst    5307    1005       0       0
    both     109      54       0       0
   total    8477    1607     471     298
--------------------------------------------------
service rule counts          to-srv  to-cli
                      bgp:        5       1
                   dcerpc:     1367     832
                     dhcp:       37      10
                     dnp3:        0       6
                      dns:      276     117
                     drda:        5       0
                     file:      710     721
                  file_id:      219     219
                      ftp:      196      24
                 ftp-data:      795   10720
                   gopher:        0       1
                     http:    14865   14127
                    http2:    14865   14127
                    http3:    14865   14127
                    ident:        1       0
                     igmp:        1       1
                     imap:      841   10971
                      irc:       40      14
                     ircd:        9       3
                 java_rmi:       55       3
                 kerberos:       33       6
                     ldap:       47       8
                      ldp:        1       0
                   modbus:       34      10
                    mysql:       67       7
              netbios-dgm:       11      11
               netbios-ns:       15       5
              netbios-ssn:     1259     813
                  netware:        2       0
                     nntp:        2       2
                      ntp:       36       7
                  openvpn:       16      16
                     pop3:      800   10974
               postgresql:        8       0
                  printer:        6       0
                   radius:        3       2
                      rdp:       10      20
                     rtmp:        1       4
                      rtp:        1       1
                     rtsp:       17       2
                      sip:      338      44
                     smtp:     9871     748
                     snmp:       49      10
                     ssdp:       13       0
                      ssh:       10       4
                      ssl:      206     221
                   sunrpc:      130       9
                   syslog:        4       0
                 teamview:        1       2
                   telnet:       61      15
                     tftp:       11       6
                      vnc:        1       1
               vnc-server:       12      10
                     wins:        3       0
                    total:    62231   78982
--------------------------------------------------
fast pattern groups
                      src: 510
                      dst: 1629
                      any: 8
                to_server: 131
                to_client: 98
--------------------------------------------------
search engine (ac_bnfa)
                instances: 1303
                 patterns: 157303
            pattern chars: 3848078
               num states: 2945922
         num match states: 419153
             memory scale: MB
             total memory: 95.1651
           pattern memory: 9.6692
        match list memory: 50.3871
        transition memory: 34.9497
        fast pattern only: 105129
appid: MaxRss diff: 384
appid: patterns loaded: 300
--------------------------------------------------
pcap DAQ configured to read-file.
Commencing packet processing
++ [0] /home/dit/Descargas/pcaps/modbus_test_data_part1.pcap
[**] [1:17795:5] "PROTOCOL-SCADA Modbus initiate diagnostic from external source" [**]
08/26-14:01:34.211940 
[**] [1:15071:5] "PROTOCOL-SCADA Modbus exception returned" [**]
08/26-14:01:34.213852 
[**] [1:17795:5] "PROTOCOL-SCADA Modbus initiate diagnostic from external source" [**]
08/26-14:01:34.214335 
[**] [1:15071:5] "PROTOCOL-SCADA Modbus exception returned" [**]
08/26-14:01:34.216467 
[**] [1:17795:5] "PROTOCOL-SCADA Modbus initiate diagnostic from external source" [**]
08/26-14:01:34.216894 
[**] [1:15071:5] "PROTOCOL-SCADA Modbus exception returned" [**]
08/26-14:01:34.219055 
[**] [1:17795:5] "PROTOCOL-SCADA Modbus initiate diagnostic from external source" [**]
08/26-14:01:44.834827 
[**] [1:15071:5] "PROTOCOL-SCADA Modbus exception returned" [**]
08/26-14:01:44.836678 
[**] [1:17795:5] "PROTOCOL-SCADA Modbus initiate diagnostic from external source" [**]
08/26-14:01:44.837161 
[**] [1:17795:5] "PROTOCOL-SCADA Modbus initiate diagnostic from external source" [**]
08/26-14:01:50.267053 
[**] [1:17795:5] "PROTOCOL-SCADA Modbus initiate diagnostic from external source" [**]
08/26-14:02:20.209286 
[**] [1:17795:5] "PROTOCOL-SCADA Modbus initiate diagnostic from external source" [**]
08/26-14:02:23.212140 
[**] [1:17799:5] "PROTOCOL-SCADA Modbus read device identification from external source" [**]
08/26-14:06:37.917389 
[**] [1:17798:5] "PROTOCOL-SCADA Modbus report slave id from external source" [**]
08/26-14:06:37.917389 
[**] [1:17799:5] "PROTOCOL-SCADA Modbus read device identification from external source" [**]
08/26-14:06:40.290808 
[**] [1:17798:5] "PROTOCOL-SCADA Modbus report slave id from external source" [**]
08/26-14:06:40.290808 
[**] [1:17788:5] "PROTOCOL-SCADA Modbus read coils from external source" [**]
08/26-14:12:18.985618 
[**] [1:17788:5] "PROTOCOL-SCADA Modbus read coils from external source" [**]
08/26-14:12:48.742388 
[**] [1:17790:5] "PROTOCOL-SCADA Modbus read holding registers from external source" [**]
08/26-14:13:25.132184 
[**] [1:17784:5] "PROTOCOL-SCADA Modbus write single coil from external source" [**]
08/26-14:13:52.259088 
[**] [1:17784:5] "PROTOCOL-SCADA Modbus write single coil from external source" [**]
08/26-14:14:02.072127 
[**] [1:17783:5] "PROTOCOL-SCADA Modbus write single register from external source" [**]
08/26-14:14:39.997992 
-- [0] /home/dit/Descargas/pcaps/modbus_test_data_part1.pcap
--------------------------------------------------
Packet Statistics
--------------------------------------------------
daq
                    pcaps: 1
                 received: 118
                 analyzed: 118
                    allow: 118
                 rx_bytes: 8269
--------------------------------------------------
codec
                    total: 118         	(100.000%)
                      eth: 118         	(100.000%)
                     ipv4: 118         	(100.000%)
                      tcp: 118         	(100.000%)
--------------------------------------------------
Module Statistics
--------------------------------------------------
ac_bnfa
                 searches: 162
                  matches: 852
                    bytes: 4855
--------------------------------------------------
ac_full
                 searches: 6
                  matches: 103
                    bytes: 506
--------------------------------------------------
appid
                  packets: 118
        processed_packets: 114
          ignored_packets: 4
           total_sessions: 6
       service_cache_adds: 3
             bytes_in_use: 456
             items_in_use: 3
--------------------------------------------------
binder
              raw_packets: 4
                new_flows: 6
                 inspects: 10
--------------------------------------------------
detection
                 analyzed: 118
               hard_evals: 279
             raw_searches: 36
          cooked_searches: 108
             pkt_searches: 144
             pdu_searches: 18
                   alerts: 22
             total_alerts: 22
                   logged: 22
           cont_creations: 30
               cont_flows: 3
               cont_evals: 28
          cont_mismatches: 28
             cont_max_num: 3
   cont_mismatch_distance: 15
--------------------------------------------------
ips_actions
                    alert: 22
--------------------------------------------------
modbus
                 sessions: 4
                   frames: 35
  max_concurrent_sessions: 2
--------------------------------------------------
pcre
               pcre_rules: 12936
              pcre_native: 12936
--------------------------------------------------
port_scan
                  packets: 118
                 trackers: 7
--------------------------------------------------
search_engine
               max_queued: 343
            total_flushed: 421
            total_inserts: 852
             total_unique: 421
     non_qualified_events: 680
         qualified_events: 20
--------------------------------------------------
stream
                    flows: 6
--------------------------------------------------
stream_tcp
                 sessions: 6
                      max: 6
                  created: 6
                 released: 6
                 timeouts: 1
             instantiated: 5
                   setups: 6
             syn_trackers: 5
            data_trackers: 1
              segs_queued: 50
            segs_released: 50
                segs_used: 50
          rebuilt_packets: 36
            rebuilt_bytes: 1469
          server_cleanups: 2
                     syns: 5
                 syn_acks: 5
                     fins: 9
                 max_segs: 12
                max_bytes: 926
--------------------------------------------------
wizard
                tcp_scans: 12
--------------------------------------------------
Appid Statistics
--------------------------------------------------
detected apps and services
              Application: Services   Clients    Users      Payloads   Misc       Referred  
                  unknown: 4          3          0          0          0          0         
--------------------------------------------------
Summary Statistics
--------------------------------------------------
timing
                  runtime: 00:00:00
                  seconds: 0.030704
                 pkts/sec: 3843
                Mbits/sec: 2
o")~   Snort exiting
